<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dino Game + Soundboard (Volume Floating)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body {
      background: #fafafd;
      margin: 0; padding: 0; width: 100vw; height: 100vh;
      font-family: Arial, sans-serif;
      overflow-x: hidden;
      overflow-y: auto;
    }
    #bannerTop {
      width: 100vw; display: flex; flex-direction: column; align-items: center;
      margin-top: 25px; margin-bottom: 4px;
      user-select: none; pointer-events: none;
    }
    #bannerRow {
      display: flex; align-items: center; gap: 13px;
      font-size: 25px; font-weight: bold; color: #151616; letter-spacing: 2.4px;
    }
    #bannerImg {
      height: 54px; width: auto; object-fit: contain; vertical-align: middle; margin: 0 3px;
      border-radius: 0; box-shadow: none; background: none; border: none; display: inline-block;
    }
    #bannerSub {
      font-size: 15px; color: #5e5e5e; margin-top: 1px; letter-spacing: 1px;
      font-family: monospace, Arial, sans-serif; text-align: center;
    }
    #gameArea {
      margin: 0 auto;
      margin-top: 18px;
      width: 95vw; max-width: 1040px; height: 55vh; max-height: 410px; min-height: 200px;
      background: #fafafd; border-radius: 18px; box-shadow: 0 4px 32px 0 #edeef329;
      position: relative; overflow: hidden;
      display: flex; justify-content: center; align-items: flex-end;
    }
    #gameCanvas { display: block; width: 100%; height: 100%; background: #fafafd; }
    #scoreBox {
      position: absolute; top: 22px; right: 50px;
      font-size: 23px; color: #464646; letter-spacing: 2px;
      font-family: monospace, Arial, sans-serif; z-index: 10; user-select: none;
      background: rgba(255,255,255,0.94); padding: 2px 14px 2px 12px;
      border-radius: 7px; font-weight: bold; box-shadow: 0 2px 10px #e6eaf245;
    }
    #gameOverBox {
      position: absolute; left: 50%; top: 70px; width: 370px; max-width: 90vw;
      transform: translateX(-50%);
      background: #fff; color: #222; font-size: 28px; font-weight: bold; text-align: center;
      border: 1.4px solid #ececec; border-radius: 10px; box-shadow: 0 6px 24px 0 #e6eaf2a7;
      padding: 23px 13px 14px 13px; display: none; z-index: 12;
    }
    #restartHint { display: block; color: #555; font-size: 15px; font-weight: normal; margin-top: 12px; letter-spacing: 1px; }
    #codeMsg {
      position: absolute; left: 50%; top: 20%; transform: translateX(-50%);
      background: #fffdfaee; color: #1b1263; font-family: monospace, Arial, sans-serif;
      font-size: 22px; padding: 8px 20px 8px 20px; border-radius: 12px; font-weight: bold;
      box-shadow: 0 3px 18px #ececec93; border: 1.2px solid #ececec; z-index: 15;
      display: none; pointer-events: none; user-select: text; text-align: center;
    }
    /* VOLUME CONTROL FLOATING KANAN ATAS */
    #soundControlBox {
      position: fixed;
      top: 20px;
      right: 22px;
      z-index: 999;
      background: rgba(255,255,255,0.98);
      border-radius: 9px;
      box-shadow: 0 2px 10px #e5e5e577;
      padding: 5px 13px;
      display: flex;
      align-items: center;
      gap: 7px;
      user-select: none;
      border: 1.1px solid #f0f0f0;
    }
    #soundControlBox button {
      border: none;
      background: none;
      font-size: 20px;
      cursor: pointer;
      padding: 1px 3px;
      color: #333;
      border-radius: 4px;
      transition: background 0.14s;
    }
    #soundControlBox button:active { background: #ededed; }
    #volumeRange {
      width: 60px;
      accent-color: #845eed;
      vertical-align: middle;
    }
    @media (max-width: 800px) {
      #gameArea {max-width: 99vw; height: 44vh; min-height: 150px;}
      #bannerImg {height: 32px;}
      #gameOverBox {font-size: 19px;}
      #bannerRow {font-size: 18px;}
      #bannerSub {font-size: 13px;}
      #scoreBox {font-size: 16px;}
      #codeMsg {font-size: 16px;}
      #soundControlBox {padding: 3px 7px; top: 10px; right: 5px;}
      #volumeRange {width: 40px;}
    }
  </style>
</head>
<body>
<div id="bannerTop">
  <div id="bannerRow">
    No 
    <img id="bannerImg" src="banner.png" alt="Banner" />
    Code
  </div>
  <div id="bannerSub">lets found it !</div>
</div>
<div id="gameArea">
  <canvas id="gameCanvas"></canvas>
  <div id="scoreBox">0</div>
  <div id="gameOverBox">
    <span id="gameOverText">Game Over</span>
    <span id="restartHint">Tekan <b>Spasi</b> atau klik/tap untuk main lagi</span>
  </div>
  <div id="codeMsg"></div>
</div>
<!-- VOLUME CONTROL FLOATING (di luar area game!) -->
<div id="soundControlBox">
  <button id="volDown" title="Volume -">ðŸ”‰</button>
  <input id="volumeRange" type="range" min="0" max="100" value="70" />
  <button id="volUp" title="Volume +">ðŸ”Š</button>
</div>

<script>
  // ======= ASSETS (GAME)
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  const scoreBox = document.getElementById('scoreBox');
  const gameOverBox = document.getElementById('gameOverBox');
  const codeMsg = document.getElementById('codeMsg');
  const dinoGif = new Image();
  dinoGif.src = "dino.png";
  const logoImg = new Image();
  logoImg.src = "logo.png";
  const cactusImg = new Image();
  cactusImg.src = "katkus.png";

  // ====== SOUND BOARD ======
  const backsound = new Audio("backsound.mp3");
  backsound.loop = true;
  backsound.preload = "auto";
  backsound.volume = 0.7;

  const jumpSound = new Audio("jump.mp3");
  jumpSound.preload = "auto";
  jumpSound.volume = 0.7;

  const rewardSound = new Audio("reward.mp3");
  rewardSound.preload = "auto";
  rewardSound.volume = 0.7;

  const gameoverSound = new Audio("gameover.mp3");
  gameoverSound.preload = "auto";
  gameoverSound.volume = 0.7;

  // Volume control UI
  let volume = 0.7;
  const volRange = document.getElementById("volumeRange");
  const volDown = document.getElementById("volDown");
  const volUp = document.getElementById("volUp");
  function setAllVolume(val) {
    volume = Math.max(0, Math.min(1, val));
    backsound.volume = volume;
    jumpSound.volume = volume;
    rewardSound.volume = volume;
    gameoverSound.volume = volume;
    volRange.value = Math.round(volume*100);
  }
  volRange.addEventListener('input', e => setAllVolume(e.target.value/100));
  volDown.addEventListener('click', ()=> setAllVolume(volume-0.12));
  volUp.addEventListener('click', ()=> setAllVolume(volume+0.12));

  // ======= VARIABEL GAME
  let W = 900, H = 300, groundY = 240;
  let dino = {}, obstacles = [], score = 0, isDead = false, gameStarted = false;
  let lastObstacle = 0, obsInterval = 2000, obsSpeed = 2.0;
  let gravity = 0.35, jumpPower = 11.8;
  let jumpSuccess = 0;
  let logoBonus = null;

  function resizeCanvas() {
    const ga = document.getElementById('gameArea');
    W = ga.clientWidth || 900;
    H = ga.clientHeight || 300;
    canvas.width = W;
    canvas.height = H;
    groundY = Math.round(H * 0.80);
    if (!gameStarted) drawStart();
  }

  function resetGame() {
    dino = {
      x: Math.max(32, Math.round(W*0.060)),
      y: groundY - 102,
      vy: 0,
      w: 82,
      h: 100,
      isJump: false
    };
    obstacles = [];
    score = 0;
    isDead = false;
    gameStarted = false;
    obsInterval = 1700;
    obsSpeed = 2.2;
    jumpSuccess = 0;
    logoBonus = null;
    scoreBox.textContent = "0";
    gameOverBox.style.display = "none";
    codeMsg.style.display = "none";
    drawStart();
    backsound.pause();
    backsound.currentTime = 0;
  }

  function drawDinoGif(x, y) {
    ctx.save();
    ctx.drawImage(dinoGif, x, y, dino.w, dino.h);
    ctx.restore();
  }
  function drawCactus(obs) {
    ctx.save();
    ctx.drawImage(cactusImg, obs.x, obs.y, obs.w, obs.h);
    ctx.restore();
  }
  function drawLogoBonus(obj) {
    ctx.save();
    ctx.globalAlpha = 0.97;
    ctx.drawImage(logoImg, obj.x, obj.y, obj.w, obj.h);
    ctx.restore();
  }

  function drawStart() {
    ctx.clearRect(0,0,W,H);
    ctx.strokeStyle = "#d3d3d3";
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.moveTo(0, groundY + 0.5);
    ctx.lineTo(W, groundY + 0.5);
    ctx.stroke();
    if (dinoGif.complete) drawDinoGif(dino.x, dino.y);
    ctx.font = "18px Arial";
    ctx.fillStyle = "#222";
    ctx.textAlign = "center";
    ctx.globalAlpha = 0.7;
    ctx.fillText("Tekan Spasi / Klik / Tap untuk mulai", W/2, groundY-25);
    ctx.globalAlpha = 1;
  }

  function randomCode(length=8) {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    let code = '';
    for (let i = 0; i < length; ++i)
      code += chars.charAt(Math.floor(Math.random() * chars.length));
    return code;
  }
  function showCongratsCode() {
    let kode = randomCode(8);
    codeMsg.innerHTML = `ðŸ¥³ congrats "<b>${kode}</b>" welcome`;
    codeMsg.style.display = "block";
    rewardSound.currentTime = 0;
    rewardSound.play();
    setTimeout(()=>{ codeMsg.style.display = "none"; }, 2200);
  }

  function gameLoop(ts) {
    if (isDead) return;
    ctx.clearRect(0,0,W,H);
    ctx.strokeStyle = "#d3d3d3";
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.moveTo(0, groundY + 0.5);
    ctx.lineTo(W, groundY + 0.5);
    ctx.stroke();

    drawDinoGif(dino.x, dino.y);
    for (let obs of obstacles) drawCactus(obs);

    // Logo bonus
    if (logoBonus && logoBonus.active) {
      drawLogoBonus(logoBonus);
      logoBonus.x -= obsSpeed;
      if (
        dino.x + dino.w - 20 > logoBonus.x &&
        dino.x + 20 < logoBonus.x + logoBonus.w &&
        dino.y < logoBonus.y + logoBonus.h &&
        dino.y + dino.h - 20 > logoBonus.y
      ) {
        logoBonus.active = false;
        showCongratsCode();
      }
      if (logoBonus.x < -logoBonus.w) logoBonus.active = false;
    }

    for (let obs of obstacles) obs.x -= obsSpeed;
    if (obstacles.length && obstacles[0].x < -60) obstacles.shift();

    if (performance.now() - lastObstacle > obsInterval) {
      let obsY = groundY - 52;
      obstacles.push({ x: W - 70, y: obsY, w: 46, h: 52 });
      lastObstacle = performance.now();
      obsInterval = 1200 + Math.random() * 1200;
    }

    if (dino.isJump) {
      dino.y += dino.vy;
      dino.vy += gravity;
      if (dino.y >= groundY - dino.h) {
        dino.y = groundY - dino.h;
        dino.isJump = false;
      }
    }

    for (let obs of obstacles) {
      if (
        dino.x + dino.w - 20 > obs.x &&
        dino.x + 20 < obs.x + obs.w &&
        dino.y + dino.h - 18 > obs.y + 8
      ) {
        isDead = true;
        gameOverBox.style.display = "block";
        codeMsg.style.display = "none";
        backsound.pause();
        gameoverSound.currentTime = 0;
        gameoverSound.play();
      }
    }

    for (let obs of obstacles) {
      if (!obs.counted && obs.x + obs.w < dino.x + 5) {
        score++;
        obs.counted = true;
        scoreBox.textContent = score;
        jumpSuccess++;
        if (jumpSuccess % 4 === 0) {
          logoBonus = {
            x: dino.x + 220,
            y: dino.y - 62,
            w: 44,
            h: 44,
            active: true
          };
        }
      }
    }
    requestAnimationFrame(gameLoop);
  }

  function jumpOrRestart() {
    if (!gameStarted) {
      gameStarted = true;
      dino.isJump = false;
      dino.y = groundY - dino.h;
      dino.vy = 0;
      obstacles = [];
      lastObstacle = performance.now();
      score = 0;
      jumpSuccess = 0;
      logoBonus = null;
      scoreBox.textContent = "0";
      codeMsg.style.display = "none";
      isDead = false;
      gameOverBox.style.display = "none";
      // === START BACKSOUND ===
      backsound.currentTime = 0;
      backsound.play();
      requestAnimationFrame(gameLoop);
    }
    if (!isDead && !dino.isJump && gameStarted) {
      dino.isJump = true;
      dino.vy = -jumpPower;
      jumpSound.currentTime = 0;
      jumpSound.play();
    } else if (isDead) {
      resetGame();
    }
  }
  window.addEventListener('keydown', e => {
    if (e.code === "Space") { e.preventDefault(); jumpOrRestart();}
  });
  canvas.addEventListener('mousedown', jumpOrRestart);
  canvas.addEventListener('touchstart', jumpOrRestart);

  window.addEventListener('resize', resizeCanvas);
  let readyCount = 0;
  function checkReady() { readyCount++; if (readyCount >= 3) { resetGame(); resizeCanvas(); } }
  dinoGif.onload = checkReady;
  logoImg.onload = checkReady;
  cactusImg.onload = checkReady;
  if (dinoGif.complete && logoImg.complete && cactusImg.complete) { resetGame(); resizeCanvas(); }

  // === Stop backsound jika user keluar/jeda ===
  window.addEventListener('blur', ()=> backsound.pause());
  window.addEventListener('focus', ()=> {if(gameStarted&&!isDead){backsound.play();}});
</script>
</body>
</html>
